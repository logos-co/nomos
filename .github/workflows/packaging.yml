name: Packaging

on:
  #  push:
  #    tags:
  #      - 'v*.*.*'
  #    branches:
  #      - master
  pull_request:

jobs:
  package:
    name: Package
    strategy:
      fail-fast: false
      matrix:
        platform:
          - os: linux
            cpu: amd64
          #          - os: linux
          #            cpu: i386
          - os: macos
            cpu: amd64
          - os: windows
            cpu: amd64
        include:
          - platform:
              os: linux
            builder: ubuntu-22.04
            shell: bash
          - platform:
              os: macos
            builder: macos-13
            shell: bash
          - platform:
              os: windows
            builder: windows-2022
            shell: msys2 {0}
    runs-on:
      ${{ matrix.platform.os }}
    defaults:
      run:
        shell: ${{ matrix.shell }}
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Build and package
        run: |
          BUILD_PACKAGE=true cargo build

#      - name: Export artifacts
#        uses: actions/upload-artifact@v2
#        with:
#          name: ${{ runner.os }}-${{ matrix.platform.cpu }}-${{ matrix.builder }}
